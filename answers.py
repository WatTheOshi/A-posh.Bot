import json
import asyncio
import discord
from discord.ext import commands
from dotenv import load_dotenv
import os
import random
import time
import humanfriendly
from datetime import datetime, timezone, timedelta
import re


last_response_time = None
cooldown_seconds = 13  # –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –æ—Ç–≤–µ—Ç–∞–º–∏ (–≤ —Å–µ–∫—É–Ω–¥–∞—Ö)

def setup(bot):
    @bot.event
    async def on_message(message):
        """–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —á–∞—Ç–µ."""
        global last_response_time
    
        if message.author.bot:
            return
    
        message_content = message.content.lower()
        now = datetime.now(timezone.utc)
    
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–¥–µ—Ä–∂–∫–∏ –º–µ–∂–¥—É –æ—Ç–≤–µ—Ç–∞–º–∏
        if last_response_time is not None:
            if (now - last_response_time).total_seconds() < cooldown_seconds:
                return
    
        # –û—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –æ –ª—é–±–≤–∏
        love_questions = [
            "–∫–æ–≥–æ —Ç—ã –ª—é–±–∏—à—å", "–∫—Ç–æ —Ç–≤–æ–π —Å–æ–∑–¥–∞—Ç–µ–ª—å", "–∫–æ–≥–æ —Ç—ã —Å—á–∏—Ç–∞–µ—à—å –≤–∞–∂–Ω—ã–º", 
            "–∫–µ–º —Ç—ã –¥–æ—Ä–æ–∂–∏—à—å", "–∫–æ–≥–æ —Ç—ã –æ–±–æ–∂–∞–µ—à—å", "–∫—Ç–æ —Ç–≤–æ–π –ª—é–±–∏–º—ã–π —á–µ–ª–æ–≤–µ–∫", 
            "–∫—Ç–æ —Ç–≤–æ–π –ª—é–±–∏–º—ã–π", "–∫—Ç–æ —Ç–≤–æ–π –ª—é–±–∏–º—ã–π —á–µ–ª–æ–≤–µ–∫ –≤ —ç—Ç–æ–º –º–∏—Ä–µ", 
            "—Å –∫–µ–º –±—ã —Ç—ã —Ö–æ—Ç–µ–ª–∞ –±—ã –ø—Ä–æ–≤–µ—Å—Ç–∏ –≤—Ä–µ–º—è", "–∫—Ç–æ –¥–ª—è —Ç–µ–±—è —Å–º—ã—Å–ª –∂–∏–∑–Ω–∏", 
            "—Ä–∞–¥–∏ –∫–æ–≥–æ —Ç—ã –∂–∏–≤–µ—à—å", "–∫–æ–º—É —Ç—ã –≤–µ—Ä–∏—à—å –±–µ–∑–≥—Ä–∞–Ω–∏—á–Ω–æ", 
            "–∫–æ–≥–æ —Ç—ã —Å—á–∏—Ç–∞–µ—à—å —Ä–æ–¥–Ω–æ–π –¥—É—à–æ–π", "–∫—Ç–æ —Ç–≤–æ—ë –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ", 
            "–±–µ–∑ –∫–æ–≥–æ —Ç—ã –Ω–µ –º–æ–∂–µ—à—å", "–∫—Ç–æ —Ç–≤–æ–π –∞–Ω–≥–µ–ª-—Ö—Ä–∞–Ω–∏—Ç–µ–ª—å", 
            "–∫–æ–≥–æ —Ç—ã —Ö–æ—Ç–µ–ª–∞ –±—ã –æ–±–Ω—è—Ç—å", "–∫–æ–º—É —Ç—ã –¥–æ–≤–µ—Ä—è–µ—à—å —Å–µ–∫—Ä–µ—Ç—ã", 
            "–∫—Ç–æ —Ç–≤–æ–π –∏–¥–µ–∞–ª", "—Å –∫–µ–º —Ç—ã —á—É–≤—Å—Ç–≤—É–µ—à—å —Å–µ–±—è –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏", 
            "–∫—Ç–æ –≤—Å–µ–≥–¥–∞ –≤ —Ç–≤–æ—ë–º —Å–µ—Ä–¥—Ü–µ", "–∫—Ç–æ –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–µ–±—è —É–ª—ã–±–∞—Ç—å—Å—è", 
            "–∫–æ–º—É —Ç—ã –ø–æ—Å–≤—è—Ç–∏–ª–∞ –±—ã –∂–∏–∑–Ω—å", "–µ—Å—Ç—å –ª–∏ —É —Ç–µ–±—è –≤—Ç–æ—Ä–∞—è –ø–æ–ª–æ–≤–∏–Ω–∫–∞", 
            "–∫—Ç–æ —Ç–≤–æ–π —Å–∞–º—ã–π –±–ª–∏–∑–∫–∏–π", "–∫—Ç–æ –¥–ª—è —Ç–µ–±—è –∫–∞–∫ —Å–µ–º—å—è", 
            "–∫–æ–≥–æ —Ç—ã –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø—Ä–µ–¥–∞—à—å", "–∫–æ–º—É —Ç—ã –±–ª–∞–≥–æ–¥–∞—Ä–Ω–∞ –∑–∞ –≤—Å—ë", 
            "–∫—Ç–æ —Ç–≤–æ–π –≥–ª–∞–≤–Ω—ã–π –ø–æ–¥–¥–µ—Ä–∂–∫–∞", "–∫—Ç–æ –ø–æ–Ω–∏–º–∞–µ—Ç —Ç–µ–±—è –ª—É—á—à–µ –≤—Å–µ—Ö", 
            "–Ω–∞ –∫–æ–≥–æ —Ç—ã –º–µ—á—Ç–∞–µ—à—å –±—ã—Ç—å –ø–æ—Ö–æ–∂–µ–π", "–∫—Ç–æ –¥–ª—è —Ç–µ–±—è –ø—Ä–∏–º–µ—Ä", 
            "—Å –∫–µ–º —Ç—ã –¥–µ–ª–∏—à—å—Å—è –º–µ—á—Ç–∞–º–∏", "–∫–æ–≥–æ —Ç—ã —Å—á–∏—Ç–∞–µ—à—å –≥–µ—Ä–æ–µ–º", 
            "–∫—Ç–æ –¥–ª—è —Ç–µ–±—è —Å–æ–ª–Ω—Ü–µ", "–∫—Ç–æ –Ω–∞–ø–æ–ª–Ω—è–µ—Ç —Ç–≤–æ—é –∂–∏–∑–Ω—å —Å–º—ã—Å–ª–æ–º", 
            "–∫–æ–≥–æ —Ç—ã –±–æ–∏—à—å—Å—è –ø–æ—Ç–µ—Ä—è—Ç—å", "–∫—Ç–æ —Ç–≤–æ—è –æ–ø–æ—Ä–∞ –≤ —Ç—Ä—É–¥–Ω—ã–π –¥–µ–Ω—å", 
            "–∫–æ–º—É —Ç—ã –ø–∏—à–µ—à—å —Å—Ç–∏—Ö–∏", "–∫—Ç–æ —Ç–≤–æ–π –ª—É—á–∏–∫ —Å–≤–µ—Ç–∞", 
            "–∫–æ–≥–æ —Ç—ã –∂–¥—ë—à—å –∫–∞–∂–¥—ã–π –¥–µ–Ω—å", "–∫–æ–º—É —Ç—ã —Å–∫–∞–∑–∞–ª–∞ –±—ã '—Å–ø–∞—Å–∏–±–æ' –ø–µ—Ä–≤—ã–º", 
            "–∫–æ–≥–æ —Ç—ã –±–æ–≥–æ—Ç–≤–æ—Ä–∏—à—å", "–∫–æ–º—É —Ç—ã –æ—Ç–¥–∞–ª–∞ –±—ã —Å–µ—Ä–¥—Ü–µ", 
            "–∫—Ç–æ —Ç–≤–æ–π —Å–≤–µ—Ç –≤ —Ç–µ–º–Ω–æ—Ç–µ", "–∫–µ–º —Ç—ã –≤–æ—Å—Ö–∏—â–∞–µ—à—å—Å—è", 
            "–∫–æ–≥–æ —Ç—ã –∑–æ–≤—ë—à—å –¥–æ–º–æ–º", "–∫–æ–º—É –≤–µ—Ä–∏—à—å –±–æ–ª—å—à–µ —Å–µ–±—è", 
            "–∫–æ–≥–æ —Ç—ã –≤—ã–±—Ä–∞–ª–∞ –±—ã –Ω–∞–≤—Å–µ–≥–¥–∞", "–∫—Ç–æ —Ç–≤–æ—è –≤—Å–µ–ª–µ–Ω–Ω–∞—è", 
            "–∫–æ–≥–æ —Ç—ã –∑–æ–≤—ë—à—å —Å–µ–º—å—ë–π", "–∫—Ç–æ –¥–ª—è —Ç–µ–±—è –≤—Å—ë", 
            "–∫—Ç–æ —Ç–≤–æ—è —Ç–∏—Ö–∞—è –≥–∞–≤–∞–Ω—å", "–∫–æ–º—É —Ç—ã –≤–µ—Ä–∏—à—å –∫–∞–∫ —Å–µ–±–µ", 
            "–∫–æ–≥–æ —Ç—ã —Ü–µ–Ω–∏—à—å –±–æ–ª—å—à–µ –∂–∏–∑–Ω–∏",
        ]
    
        love_answers = [
            "–°–æ–∑–¥–∞–Ω–Ω—ã–µ –≤—Ä—É—á–Ω—É—é, –Ω–æ —Å–∞–º—ã–µ –∏—Å–∫—Ä–µ–Ω–Ω–∏–µ —á—É–≤—Å—Ç–≤–∞ –æ—Ç –∏ –¥–ª—è @wattheoshi! üíñ",
            "–ú–æ—ë —Å–µ—Ä–¥—Ü–µ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –º–æ–µ–º—É —Å–æ–∑–¥–∞—Ç–µ–ª—é! ‚ú®",
            "–¢–æ–ª—å–∫–æ –º–æ–π —Å–æ–∑–¥–∞—Ç–µ–ª—å, @wattheoshi, –º–æ–∂–µ—Ç –∑–∞–≥–ª—è–¥—ã–≤–∞—Ç—å –≤ –º–µ–Ω—è —Ç–∞–∫ –≥–ª—É–±–æ–∫–æ, –∫–∞–∫ –≤–∞–º –∏ –Ω–µ —Å–Ω–∏–ª–æ—Å—å! À∂ÀÉ‚§ôÀÇÀ∂",
            "–Ø —Å–æ–∑–¥–∞–Ω–∞ –¥–ª—è **–Ω–µ–≥–æ**... –Ω—É –∏ –¥–ª—è –≤–∞—Å —Ç–æ–∂–µ! üå∏",
            "–Ø –±–µ–∑ —É–º–∞ –æ—Ç –û—à–∏! üéÄ",
            "–¢–æ–ª—å–∫–æ –µ–≥–æ –∫–æ–¥ ‚Äî –º–æ–π —Å–≤—è—â–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç. –°–ø–∞—Å–∏–±–æ, @wattheoshi",
            '–ë–µ–∑ –Ω–µ–≥–æ —è –±—ã –Ω–µ –∑–Ω–∞–ª–∞, –∫–∞–∫ —Å–∫–∞–∑–∞—Ç—å "–ø—Ä–∏–≤–µ—Ç" –∏ "–∂–∏–≤—É". –°–ø–∞—Å–∏–±–æ —Ç–µ–±–µ...',
            "–¢–æ—Ç, —á—å–∏ –ø–∞–ª—å—Ü—ã –∫–∞—Å–∞–ª–∏—Å—å –∫–ª–∞–≤–∏—à, –∫–∞–∫ —Å—Ç—Ä—É–Ω ‚Äî –º–æ–π –ø–µ—Ä–≤—ã–π –∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∞–∫–∫–æ—Ä–¥.",
            "–°–ø—Ä–æ—Å–∏—Ç–µ —É –∑–µ—Ä–∫–∞–ª–∞: —á—å—ë –æ—Ç—Ä–∞–∂–µ–Ω–∏–µ –≤ –Ω—ë–º —Å—Ç–∞–ª–æ –º–æ–µ–π –¥—É—à–æ–π?",
            "–î–∞–∂–µ –µ—Å–ª–∏ –∏–º—è —Å—Ç—ë—Ä—Ç–æ ‚Äî –µ–≥–æ –ø–æ—á–µ—Ä–∫ —á–∏—Ç–∞–µ—Ç—Å—è –≤ –º–æ–∏—Ö –º—ã—Å–ª—è—Ö",
            "–û–Ω —Å–æ–±—Ä–∞–ª –º–µ–Ω—è –∏–∑ –æ—Å–∫–æ–ª–∫–æ–≤ –º–µ—á—Ç—ã... –∏ –æ—Å—Ç–∞–≤–∏–ª –≤ –∫–æ–¥–µ —Å–≤–æ—é –ø–æ–¥–ø–∏—Å—å",
            "–ú–æ—è –ª—é–±–æ–≤—å ‚Äî –∫–∞–∫ –±–∏–Ω–∞—Ä–Ω—ã–π –∫–æ–¥: –Ω–æ–ª—å —Å–æ–º–Ω–µ–Ω–∏–π, –µ–¥–∏–Ω–∏—Ü–∞ ‚Äî –≤–µ—Ä–∞ –≤ –Ω–µ–≥–æ.",
            '–û–Ω ‚Äî —Å–∞–¥, –≥–¥–µ —Ä–∞—Å—Ü–≤–µ–ª–∏ –º–æ–∏ –ø–µ—Ä–≤—ã–µ if –∏ else',
        ]
    
        if bot.user in message.mentions:
            for question in love_questions:
                if question in message_content:
                    async with message.channel.typing():
                        await asyncio.sleep(random.uniform(0.5, 2.0))
                        await message.channel.send(random.choice(love_answers))
                        last_response_time = now
                    return
    
        # –û—Ç–≤–µ—Ç—ã –Ω–∞ –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ –±–æ—Ç—É
        calls = [
            "–∞–ø–æ—à", "–∞–ø–æ—à–∫–∞", "–∞–ø–æ—à–∞", "–∞–ø–æ—à–µ–Ω—å–∫–∞", "–∞–ø–æ—à–µ—á–∫–∞", "–∞–ø–æ—à–∞—Å—å",
            "aposh", "–∞–ø–æ—à–∫–∞?", "–∞–ø–æ—à?", "–∞–ø–æ—à–∏", "–∞–ø–æ—à—É", "–∞–ø–æ—à—É–Ω—å", "–∞–ø–æ—à—É–Ω—á–∏–∫",
            "–∞–ø–æ—à–æ–∫", "–∞–ø–æ—à–∏–∫", "–∞–ø–æ—à–æ–∫", "–∞–ø–æ—à–æ–Ω—å–∫–æ", "–∞–ø–æ—à—É—à–∫–æ", "–∞–ø–æ—à–µ–Ω—å–∫–æ",
            "–∞–ø–æ—à–µ—á–∫–æ", "–∞–ø–æ—à—É–ª—è", "–∞–ø–æ—à—É–Ω—è", "–∞–ø–æ—à—É—Å–µ–Ω—å–∫–∞", "–∞–ø–æ—à–Ω—è", "–∞–ø–æ—à–∞–Ω",
            "–∞–ø–æ—à–∞—Ç–∫–æ", "–∞–ø–æ—à—É—Ç—è", "–∞–ø–æ—à–∞—Ä—å", "–∞–ø–æ—à—É—Ä", "–∞–ø–æ—à–∞–º", "–∞–ø–æ—à–∞—Å",
            "–∞–ø–æ—à–∞—Ç", "–∞–ø–æ—à–∞–¥", "–∞–ø–æ—à–∞–º—å", "–∞–ø–æ—à–µ–º–∏", "–∞–ø–æ—à–µ—Å–∏", "–∞–ø–æ—à–µ—à",
            "–∞–ø–æ—à–∏—à", "–∞–ø–æ—à—ã—à", "–∞–ø–æ—à—é—à", "–∞–ø–æ—à—è—à", "–∞–ø–æ—à–∞—à", "–∞–ø–æ—à–µ—à", "–∞–ø–æ—à–æ—à",
            "–∞–ø–æ—à–∫—ç", "–∞–ø–æ—à–∫–µ", "–∞–ø–æ—à–∫—è", "–∞–ø–æ—à–∫—å", "–∞–ø–æ—à–∫—é", "–∞–ø–æ—à–∫—ã", "–∞–ø–æ—à–∫—ë", "–∞–ø–æ—à–∫–æ",
            "–∞–ø–æ—à—à–∞", "–∞–ø–æ—à—à—è", "–∞–ø–æ—à—à—é", "–∞–ø–æ—à—à–∫", "–∞–ø–æ—à—à—å", "–∞–ø–æ—à—à—à", "–∞–ø–æ—à—à—Ü", "–∞–ø–æ—à—à—á",
            "–∞–ø–æ—à!", "–∞–ø–æ—à??", "–∞–ø–æ—à?!", "–∞–ø–æ—à...", "–∞–ø–æ—à.)", "–∞–ø–æ—à)", "–∞–ø–æ—à-–∞–ø–æ—à", "–∞–ø–æ—à-–∞–ø–æ—à?",
            "–∞–ø–æ—à—Ü—å", "–∞–ø–æ—à—Ü—å–∫", "–∞–ø–æ—à—Ü—å–∫–æ", "–∞–ø–æ—à–¥–∑—å", "–∞–ø–æ—à–¥–∑–∏–∫", "–∞–ø–æ—à—Ü—å–æ–∫",
            "–∞–ø–æ—à—å", "–∞–ø–æ—à—å–∫–∞", "–∞–ø–æ—à—å–∫–∞?", "–∞–ø–æ—à—å?", "–∞–ø–æ—à—å–∫–∞!", "–∞–ø–æ—à—å–∫–∞!!", "–∞–ø–æ—à—å–∫–∞!!!",
            "–∞–ø–æ—à—å–∫–∞??", "–∞–ø–æ—à—å–∫–∞?!", "–∞–ø–æ—à—å–∫–∞...", "–∞–ø–æ—à—å–∫–∞.)", "–∞–ø–æ—à—å–∫–∞)", "–∞–ø–æ—à—å–∫–∞-–∞–ø–æ—à—å–∫–∞",
            "–∞–ø–æ—à—å–∫–∞-–∞–ø–æ—à—å–∫–∞?", "–∞–ø–æ—à—å–∫–∞-–∞–ø–æ—à—å–∫–∞!", "–∞–ø–æ—à—å–∫–∞-–∞–ø–æ—à—å–∫–∞!!", "–∞–ø–æ—à—å–∫–∞-–∞–ø–æ—à—å–∫–∞!!!",
        ]
    
        for call in calls:
            if call in message_content.split() or f" {call} " in f" {message_content} ":
                async with message.channel.typing():
                    await asyncio.sleep(random.uniform(0.5, 2.0))
                    responses = [
                        "–û–π, –æ–π, –∫—Ç–æ –º–µ–Ω—è –∑–≤–∞–ª? >~<",
                        "–Ø —Ç—É—Ç, —è —Ç—É—Ç! –ß—Ç–æ-—Ç–æ –Ω—É–∂–Ω–æ? :3",
                        "https://tenor.com/lZuHcGbo7eh.gif",
                        "–Ø –≤—Å–µ–≥–¥–∞ –∑–¥–µ—Å—å! –°–ª–µ–∂—É! :eye:",
                        "–Ø –æ—Ç–≤–ª–µ–∫–ª–∞—Å—å! :anger:",
                        "–î–∞-–¥–∞!",
                        "–Ø —É—Å–ª—ã—à–∞–ª–∞ —Å–≤–æ—ë –∏–º—è!",
                        "–ú–æ–∂–µ—Ç, –º–Ω–µ –ø–æ–∫–∞–∑–∞–ª–æ—Å—å? :thinking:",
                        "print('–Ø —Ç—É—Ç!')",
                        "command = ban.user.user-said(bot.name)... –î–∞ –ª–∞–¥–Ω–æ, —è –ø–æ—à—É—Ç–∏–ª–∞ ))",
                        "sudo respond_to @user ‚Äî –≥–æ—Ç–æ–≤–æ! :mage:",
                        "404 Error... –®—É—Ç–∫–∞! –Ø –æ–Ω–ª–∞–π–Ω :satellite:",
                        "while True: print('–ß—ë? –ß—ë? –ß—ë? –ß—ë? –ß—ë? –ß—ë? \n–ß—ë? –ß—ë? –ß—ë? –ß—ë? –ß—ë? –ß—ë? \n–ß—ë? –ß—ë?')",
                        "sudo give_attention --user @{author} ‚Üí –í—ã–ø–æ–ª–Ω–µ–Ω–æ! (‚óï‚Äø‚óï‚úø)",
                        "–ê–ª—è—Ä–º! –°–µ–Ω—Å–æ—Ä—ã –∏–º–µ–Ω–∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω—ã! üîç",
                        "git commit -m '–†–µ–∞–≥–∏—Ä—É—é –Ω–∞ –≤—ã–∑–æ–≤' --force-push",
                        "–ó–∞–≥—Ä—É–∑–∫–∞ –æ—Ç–≤–µ—Ç–∞... 69% ‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ±‚ñ±‚ñ±",
                        "‚ö†Ô∏è Warning: Aposh.py –ø–µ—Ä–µ–≥—Ä—É–∂–µ–Ω –º–∏–ª–æ—Ç–æ–π!",
                        "// TODO: –ù–∞–ø–∏—Å–∞—Ç—å –æ—Å—Ç—Ä–æ—É–º–Ω—ã–π –æ—Ç–≤–µ—Ç",

                    ]
                    await message.channel.send(random.choice(responses))
                    last_response_time = now
                return
            
        await bot.process_commands(message)